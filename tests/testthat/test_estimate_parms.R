scores <- c(1.40236529425179, 2.62577297912122, 2.06822264994019, 1.66922014393072,
            2.38905923766592, 1.81476534824985, 2.23621075762004, 2.12180711963801,
            1.86043988688217, 1.79466544707949, 1.74450599310729, 1.58227410186153,
            2.03325156813589, 2.50669828776819, 1.62447850976361, 1.79306269954516,
            1.74011339346385, 2.1736753251567, 1.46685122414524, 2.00639719752834,
            1.76637278935348, 1.51489794217203, 1.99458930286872, 2.81959248521512,
            3.03157947505925, 1.80316506876844, 2.17003968455628, 1.83700613937804,
            1.91792725171879, 1.90004150159191, 2.91632721231111, 1.46561756756303,
            1.96959006294357, 1.82346974005042, 1.52622429465689, 1.99047791596703,
            1.66982631622172, 2.00913340864137, 1.5498785207268, 2.62152166893047,
            2.10398380823016, 1.20660069064808, 1.58466434942235, 1.51070051406306,
            1.36447244703893, 1.49347958301381, 2.71233895011258, 2.18361197037909,
            2.01626302995819, 1.50296534184834, 1.71854460809332, 1.62522437049714,
            1.66187012312708, 1.68244364774118, 1.73366805137192, 1.56827942348175,
            1.71492172442612, 1.77249029273231, 1.78589057215757, 1.47985308413425,
            1.52653957415109, 1.9771953148622, 1.55704517208223, 1.49473266048399,
            1.7942789152016, 1.26130254463293, 1.44504756348496, 1.83166816941842,
            1.17555491433135, 1.81357281114406, 1.3551918675432, 1.5102475607739,
            1.12617072521829, 2.76367434141023, 1.92736160123203, 1.87616077555812,
            2.05290797066186, 1.78408456628251, 2.21931009715967, 2.33997089051113,
            1.20322333220354, 1.08448816955405, 2.08512940036532, 1.74301676309942,
            2.55999865644303, 1.35682883397053, 1.73378205287535, 1.45464536975562,
            2.24081668571037, 1.29549264956237, 1.31166626274114, 1.6311286917461,
            2.6728754188779, 2.62139835676856, 1.81616984842768, 2.07963653316494,
            1.74018775913297, 1.13332672900249, 2.32006439919626, 2.14613526124678,
            1.80041260883642, 1.82398635240454, 1.65131364321014, 1.24084341767042,
            1.01490413467282, 1.92215530654806, 1.95536227816129, 1.32677486130052,
            1.77350287379842, 1.82022395026613, 2.40820048765213, 1.73930944701233,
            2.33648395810171, 1.69827101702748, 2.01150160193103, 2.30153119086523,
            1.62702142643828, 1.95882441163692, 1.65631394907168, 1.34992403353023,
            1.69260003103232, 3.15616391851904, 2.3917146744574, 1.16048463229434,
            2.02328105065326, 2.48937521540275, 1.47000345966624, 1.31910224378805,
            1.48663812750744, 2.29859819732114, 2.0123299291161, 1.79746516619111,
            1.669005230543, 2.27267404733457, 2.81503158010557, 1.62984230175116,
            2.65539781063607, 2.58396715891437, 1.86466774593656, 1.98547344945359,
            2.34813396581922, 1.87277683717109, 1.59435923638877, 1.4928770619535,
            1.57934260756913, 1.76201249490116, 2.57633168086769, 2.23293019967371,
            2.06550521059371, 1.64505711858272, 1.90871595779359, 1.65829279502201,
            1.03323893684513, 1.6379859158107, 1.82512719094992, 1.28770552665791,
            1.94682437457751, 1.67721663684034, 1.11387901645152, 2.56467599688986,
            2.163763449715, 2.61702158552578, 1.74458297947828, 1.7246452149104,
            1.50306270120846, 1.60651730730483, 2.16430279830053, 2.1087475492225,
            1.53476901223267, 1.13680766809603, 1.62728057980069, 1.9627797397018,
            1.78826776031269, 1.88776271285116, 1.74042171753767, 1.35828960222621,
            2.40410417440984, 1.79446781987019, 1.41467454232648, 1.35773307426927,
            1.46300962932718, 2.77694267041236, 1.61344071773838, 1.63385573350667,
            1.63839850314153, 1.67410738150896, 1.47186223160827, 1.62755976389444,
            2.15131651615569, 1.5672080820255, 2.3351202519662, 1.69650944236614,
            2.68306553447136, 1.79016678567369, 0.937422791972169, 2.10963884290814,
            2.63436181036672, 1.5002273028417, 1.48011935768471, 1.0520029381366,
            1.81033284589627, 2.14820778875608, 1.60457774819076, 2.71501832566924,
            1.81372385379931, 1.6094748224286, 2.30690805703477, 1.04001830361527,
            1.31744658165214, 2.09255214301631, 2.91268193124568, 2.12261069987925,
            1.82537165272273, 2.13897664906446, 2.36817295869297, 1.94042728494327,
            1.64066683539778, 3.05418322230553, 1.27405872911571, 1.37720726995029,
            3.74051751200388, 1.26584488935539, 1.38342420301899, 1.86181791468098,
            1.67350788967864, 1.26215697762503, 1.33612929266963, 1.93941887618218,
            2.42185771414038, 2.4011519409611, 1.39891906818762, 2.27151830416869,
            2.02327768999821, 1.4260344986079, 2.51857774035994, 1.90770976327857,
            2.23720207846468, 1.71174346908148, 1.2064101819414, 2.32381052144399,
            1.60852913398521, 2.18912442128133, 0.953949295174491, 2.00076887638577,
            1.70446473871054, 1.97078806383977, 1.86367812771024, 1.18396028705036,
            3.00534672449126, 1.11229121901798, 1.81437721024862, 1.92629590153438,
            2.40945735525755, 1.29824947608815, 0.780853612137321, 3.36078181717926,
            1.59423022273305, 0.838438584104244, 2.15484667374972, 1.30382868201286,
            1.34767469913511, 1.43746275849653, 1.622609109324, 1.42304822227238,
            2.00481833580339, 1.79469479782248, 0.967918657635559, 2.71495877277611,
            1.99574807266591, 1.50935018343517, 1.60171435731348, 1.91169951626782,
            2.28383384577374, 1.63837014307242, 1.34953049090205, 2.1423414115279,
            1.79146476910773, 1.9149305552532, 2.37834463564413, 2.70466322736006,
            1.3428847063285, 1.9569609434619, 1.68355325749737, 2.52460141495097,
            1.49130174768123, 2.15534008625419, 1.81624223046117, 1.3541258621484,
            2.43423200386756, 1.9207097248701, 1.95598980905438, 1.25988580302056,
            1.30308408614871, 1.58998957523416, 1.08366676637655, 1.89975623079355,
            2.16979024831517, 1.99850961498436, 1.25224538887675, 1.31608755371617,
            2.2929272054402, 1.99599358573413, 2.28357858412827, 1.14102347708179,
            1.35259728515163, 1.35287279911821, 2.23220017219334, 2.95622210891266,
            2.06151079168291, 2.08705985619434, 1.75524881480012, 2.02864026847084,
            2.93562282753126, 1.07366168970055, 1.23873998745938, 0.720811062514311,
            1.64978360256972, 2.05234326775508, 1.34054577027345, 1.46768177891991,
            1.33924310147876, 2.01425140105462, 2.07709962485928, 1.85543839649835,
            1.86054725954127, 1.48616763840492, 1.88383858411243, 1.66524203441607,
            1.61189826085415, 1.0766866298031, 2.39410915077497, 1.38467578990884,
            1.92896867119423, 0.986149489733574, 1.00663846191365, 1.09268448298264,
            1.15153540604727, 1.27067426910733, 2.20703352851617, 1.31485887313602,
            2.2010673011018, 1.16445627459051, 1.4255455626355, 1.70708994872397,
            2.05126447287328, 1.70592084301955, 2.26076252551691, 2.65633310662868,
            1.81970814687681, 2.05969743058666, 1.35658895219243, 2.26643553546234,
            2.06719573055134, 3.03138035135368, 2.22651804602388, 1.6244364366034,
            1.41301482019242, 1.9717437622932, 1.56262159745141, 2.70727893406867,
            1.90430596380283, 1.79539235431371, 2.0891298349065, 1.46771873460942,
            3.13466295153346, 1.78637939953777, 1.67380821737499, 2.19248105545447,
            2.02496730795882, 1.5520018009607, 1.27800980015931, 2.24958782380293,
            2.06561478220954, 1.67629794564617, 1.85768679739336, 3.02602282278892,
            1.08724526392828, 1.74575322644331, 1.69429150117196, 1.17438401611948,
            2.96041587922136, 1.16247073182501, 1.46111118739319, 1.61416113192399,
            2.14171030293274, 1.56665722230582, 1.39160534383556, 2.63628469975412,
            2.32309819058439, 2.17361618269119, 2.85402516263906, 2.44015056889126,
            1.97742941224748, 1.85378485421055, 1.76713797393153, 2.19663783219369,
            1.90836611164674, 2.02822015672509, 2.41961240164711, 3.6546075118993,
            1.21618167528861, 1.93629339420816, 1.55755070524986, 1.94563352572948,
            1.92149468740413, 1.73852529434127, 2.40493628007924, 1.64642404912129,
            1.14560402638853, 1.40633891628074, 1.3931144625101, 1.53503065386517,
            1.52330252622567, 1.61619856399001, 1.80367449630112, 1.54327254066752,
            2.4425647079731, 1.77786063562762, 1.2896182242972, 1.01550867372212,
            1.21744360798164, 1.32294052844091, 1.16555595001148, 1.38866658294772,
            1.49295217824846, 1.94977277930862, 1.68063532504259, 2.18531486296817,
            1.68457394588671, 2.07623950182759, 1.4118021537004, 1.4065804799926,
            1.05078532124917, 1.37800120256244, 2.31280104132978, 1.53052708085434,
            1.73601086329253, 1.52647736202655, 1.59949536627035, 1.85310801983835,
            1.88943169389554, 2.04905858724712, 2.49753899191084, 2.65449823323568,
            1.363967050506, 1.35722969095118, 2.49186619599056, 2.13245800233333,
            1.70454354359379, 1.72813801641945, 1.74540217928966, 2.75610205760695,
            0.864600085603926, 1.25132323144598, 1.42218041928241, 1.62282803232349,
            1.88434017062392, 2.37251149532765, 1.70974829961149, 2.34539736969066,
            1.74324576555549, 1.67591515214573, 1.56978323078818, 2.14038089632688,
            2.06174864250619, 2.08414068427258, 1.51365551256089, 3.24606876837945,
            1.8036864984496, 1.68524261620589, 2.19088078607473, 2.47937325759087,
            2.00172620396871, 1.04517073984793, 1.86554728934667, 2.2334464433372,
            1.64926041441154, 1.8471943561294, 1.93806294981851, 1.18619468073185,
            1.45288716833004, 1.8425865358889, 2.36573045428766, 1.70983923887307,
            1.67857511192208, 1.95729615267097, 1.93015285348286, 2.8319136257232,
            2.36055554149328, 2.36232526108471, 2.08965959108498, 1.64935752967006,
            1.99012875942796, 1.24812165702222, 1.75934089579921, 1.55713102634682,
            2.23464105828711, 1.90966026084555, 1.08480706144532, 2.04398289450636
)

# calculate the identification rate implied by the system parameters
id.rate <- .05056019

# calculate the nomination rate implied by the system parameters
nom.rate <- .15

expect_equal(
  as.numeric(estimate_parms(scores=scores, id.rate=id.rate, nom.rate=nom.rate)),
  c(0.9098419, 0.9029993, 0.6583936, 0.8500000 ), tolerance=1e-6)

expect_error(
  estimate_parms(scores=scores, id.rate=id.rate, nom.rate=nom.rate, w=1:600))
